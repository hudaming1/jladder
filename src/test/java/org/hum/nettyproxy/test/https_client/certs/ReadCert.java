package org.hum.nettyproxy.test.https_client.certs;

import java.io.ByteArrayInputStream;
import java.io.DataInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.security.KeyStore;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.cert.Certificate;
import java.security.cert.CertificateException;
import java.security.cert.CertificateFactory;
import java.security.cert.X509Certificate;
import java.util.Arrays;
import java.util.Enumeration;

import org.junit.Test;

import sun.misc.BASE64Encoder;

public class ReadCert {

	@Test
	public void testReadCert() throws CertificateException, FileNotFoundException {
		CertificateFactory cf = CertificateFactory.getInstance("X.509");
		X509Certificate cert = (X509Certificate) cf.generateCertificate(new FileInputStream(
				"/Users/hudaming/Workspace/GitHub/netty-proxy/src/test/java/org/hum/nettyproxy/test/https_client/certs/FiddlerRoot.cer"));
		PublicKey publicKey = cert.getPublicKey();
		BASE64Encoder base64Encoder = new BASE64Encoder();
		String publicKeyString = base64Encoder.encode(publicKey.getEncoded());
		System.out.println("-----------------公钥--------------------");
		System.out.println(publicKeyString);
		System.out.println("-----------------公钥--------------------");
	}

	@Test
	public void testReadCert2() throws Exception {
		FileInputStream fileInputStream = new FileInputStream(
				"/Users/hudaming/Workspace/GitHub/netty-proxy/src/test/java/org/hum/nettyproxy/test/https_client/certs/FiddlerRoot.cer");
		DataInputStream dataInputStream = new DataInputStream(fileInputStream);
		byte[] bytes = new byte[dataInputStream.available()];
		dataInputStream.read(bytes);
		System.out.println(Arrays.toString(bytes));
		dataInputStream.close();
	}

	@Test
	public void testReadCert3() throws Exception {
//		byte[] bytes = new byte[] { 48, -126, 9, -81, 48, -126, 8, -105, -96, 3, 2, 1, 2, 2, 12, 44, -18, 25, 60, 24, -126, 120, -22, 62, 67, 117, 115, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 11, 5, 0, 48, 102, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 66, 69, 49, 25, 48, 23, 6, 3, 85, 4, 10, 19, 16, 71, 108, 111, 98, 97, 108, 83, 105, 103, 110, 32, 110, 118, 45, 115, 97, 49, 60, 48, 58, 6, 3, 85, 4, 3, 19, 51, 71, 108, 111, 98, 97, 108, 83, 105, 103, 110, 32, 79, 114, 103, 97, 110, 105, 122, 97, 116, 105, 111, 110, 32, 86, 97, 108, 105, 100, 97, 116, 105, 111, 110, 32, 67, 65, 32, 45, 32, 83, 72, 65, 50, 53, 54, 32, 45, 32, 71, 50, 48, 30, 23, 13, 49, 57, 48, 53, 48, 57, 48, 49, 50, 50, 48, 50, 90, 23, 13, 50, 48, 48, 54, 50, 53, 48, 53, 51, 49, 48, 50, 90, 48, -127, -89, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 67, 78, 49, 16, 48, 14, 6, 3, 85, 4, 8, 19, 7, 98, 101, 105, 106, 105, 110, 103, 49, 16, 48, 14, 6, 3, 85, 4, 7, 19, 7, 98, 101, 105, 106, 105, 110, 103, 49, 37, 48, 35, 6, 3, 85, 4, 11, 19, 28, 115, 101, 114, 118, 105, 99, 101, 32, 111, 112, 101, 114, 97, 116, 105, 111, 110, 32, 100, 101, 112, 97, 114, 116, 109, 101, 110, 116, 49, 57, 48, 55, 6, 3, 85, 4, 10, 19, 48, 66, 101, 105, 106, 105, 110, 103, 32, 66, 97, 105, 100, 117, 32, 78, 101, 116, 99, 111, 109, 32, 83, 99, 105, 101, 110, 99, 101, 32, 84, 101, 99, 104, 110, 111, 108, 111, 103, 121, 32, 67, 111, 46, 44, 32, 76, 116, 100, 49, 18, 48, 16, 6, 3, 85, 4, 3, 19, 9, 98, 97, 105, 100, 117, 46, 99, 111, 109, 48, -126, 1, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 1, 15, 0, 48, -126, 1, 10, 2, -126, 1, 1, 0, -76, -58, -65, -38, 83, 32, 15, -22, 64, -13, -72, 82, 23, 102, 59, 54, 1, -115, 18, -76, -103, 13, -45, -101, 108, 24, 83, -79, 25, 8, -80, -6, 115, 71, 62, 13, 58, 121, 98, 120, 97, 46, 84, 60, 73, 124, 86, -38, -64, -66, 97, 85, -43, 66, 112, 106, 16, -66, -11, -67, -115, 100, -106, 33, 0, -109, 99, 9, -121, -73, 25, -70, 14, 32, 62, 73, -56, 83, -19, 2, -113, 70, 1, -21, -95, 7, -109, 115, -69, -19, -15, -77, -55, -30, -5, -35, -16, 57, 42, -125, -83, -12, 65, -104, -68, -122, -22, -70, 116, -88, -90, -29, -48, -27, -59, -114, -77, 11, -78, -46, -84, -111, 116, 14, -1, -128, 16, 35, 54, 98, 101, 8, -76, -121, -11, 87, 12, 37, -57, 0, -40, -11, -88, 93, -72, 51, 65, -89, 42, 95, -37, -6, 112, -98, 33, -69, -82, 66, 22, 102, 7, 105, -2, 28, 38, 42, -127, 15, -85, 115, -29, -42, 82, 32, -92, 109, -88, 108, -44, 102, 72, -92, 111, -14, 104, 10, -59, 101, -95, 78, -65, 4, 122, 64, 67, 28, -45, 117, -5, 117, -84, 25, -42, 74, 53, 5, 110, -49, -43, 101, -47, 68, -54, 107, 12, 88, 4, -60, -123, 79, 31, -66, 44, 50, -47, -15, -58, 40, -5, -7, 38, 54, -75, 109, -6, -53, -106, -94, -96, -48, -68, -8, 81, -33, 7, 68, -67, -113, 111, 103, -64, -44, -81, -39, -51, -61, 2, 3, 1, 0, 1, -93, -126, 6, 25, 48, -126, 6, 21, 48, 14, 6, 3, 85, 29, 15, 1, 1, -1, 4, 4, 3, 2, 5, -96, 48, -127, -96, 6, 8, 43, 6, 1, 5, 5, 7, 1, 1, 4, -127, -109, 48, -127, -112, 48, 77, 6, 8, 43, 6, 1, 5, 5, 7, 48, 2, -122, 65, 104, 116, 116, 112, 58, 47, 47, 115, 101, 99, 117, 114, 101, 46, 103, 108, 111, 98, 97, 108, 115, 105, 103, 110, 46, 99, 111, 109, 47, 99, 97, 99, 101, 114, 116, 47, 103, 115, 111, 114, 103, 97, 110, 105, 122, 97, 116, 105, 111, 110, 118, 97, 108, 115, 104, 97, 50, 103, 50, 114, 49, 46, 99, 114, 116, 48, 63, 6, 8, 43, 6, 1, 5, 5, 7, 48, 1, -122, 51, 104, 116, 116, 112, 58, 47, 47, 111, 99, 115, 112, 50, 46, 103, 108, 111, 98, 97, 108, 115, 105, 103, 110, 46, 99, 111, 109, 47, 103, 115, 111, 114, 103, 97, 110, 105, 122, 97, 116, 105, 111, 110, 118, 97, 108, 115, 104, 97, 50, 103, 50, 48, 86, 6, 3, 85, 29, 32, 4, 79, 48, 77, 48, 65, 6, 9, 43, 6, 1, 4, 1, -96, 50, 1, 20, 48, 52, 48, 50, 6, 8, 43, 6, 1, 5, 5, 7, 2, 1, 22, 38, 104, 116, 116, 112, 115, 58, 47, 47, 119, 119, 119, 46, 103, 108, 111, 98, 97, 108, 115, 105, 103, 110, 46, 99, 111, 109, 47, 114, 101, 112, 111, 115, 105, 116, 111, 114, 121, 47, 48, 8, 6, 6, 103, -127, 12, 1, 2, 2, 48, 9, 6, 3, 85, 29, 19, 4, 2, 48, 0, 48, 73, 6, 3, 85, 29, 31, 4, 66, 48, 64, 48, 62, -96, 60, -96, 58, -122, 56, 104, 116, 116, 112, 58, 47, 47, 99, 114, 108, 46, 103, 108, 111, 98, 97, 108, 115, 105, 103, 110, 46, 99, 111, 109, 47, 103, 115, 47, 103, 115, 111, 114, 103, 97, 110, 105, 122, 97, 116, 105, 111, 110, 118, 97, 108, 115, 104, 97, 50, 103, 50, 46, 99, 114, 108, 48, -126, 3, 73, 6, 3, 85, 29, 17, 4, -126, 3, 64, 48, -126, 3, 60, -126, 9, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 18, 99, 108, 105, 99, 107, 46, 104, 109, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 16, 99, 109, 46, 112, 111, 115, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 16, 108, 111, 103, 46, 104, 109, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 20, 117, 112, 100, 97, 116, 101, 46, 112, 97, 110, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 16, 119, 110, 46, 112, 111, 115, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 8, 42, 46, 57, 49, 46, 99, 111, 109, -126, 11, 42, 46, 97, 105, 112, 97, 103, 101, 46, 99, 110, -126, 12, 42, 46, 97, 105, 112, 97, 103, 101, 46, 99, 111, 109, -126, 13, 42, 46, 97, 112, 111, 108, 108, 111, 46, 97, 117, 116, 111, -126, 11, 42, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 14, 42, 46, 98, 97, 105, 100, 117, 98, 99, 101, 46, 99, 111, 109, -126, 18, 42, 46, 98, 97, 105, 100, 117, 99, 111, 110, 116, 101, 110, 116, 46, 99, 111, 109, -126, 14, 42, 46, 98, 97, 105, 100, 117, 112, 99, 115, 46, 99, 111, 109, -126, 17, 42, 46, 98, 97, 105, 100, 117, 115, 116, 97, 116, 105, 99, 46, 99, 111, 109, -126, 12, 42, 46, 98, 97, 105, 102, 97, 101, 46, 99, 111, 109, -126, 14, 42, 46, 98, 97, 105, 102, 117, 98, 97, 111, 46, 99, 111, 109, -126, 15, 42, 46, 98, 99, 101, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 13, 42, 46, 98, 99, 101, 104, 111, 115, 116, 46, 99, 111, 109, -126, 11, 42, 46, 98, 100, 105, 109, 103, 46, 99, 111, 109, -126, 14, 42, 46, 98, 100, 115, 116, 97, 116, 105, 99, 46, 99, 111, 109, -126, 13, 42, 46, 98, 100, 116, 106, 114, 99, 118, 46, 99, 111, 109, -126, 17, 42, 46, 98, 106, 46, 98, 97, 105, 100, 117, 98, 99, 101, 46, 99, 111, 109, -126, 13, 42, 46, 99, 104, 117, 97, 110, 107, 101, 46, 99, 111, 109, -126, 11, 42, 46, 100, 108, 110, 101, 108, 46, 99, 111, 109, -126, 11, 42, 46, 100, 108, 110, 101, 108, 46, 111, 114, 103, -126, 18, 42, 46, 100, 117, 101, 114, 111, 115, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 16, 42, 46, 101, 121, 117, 110, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 17, 42, 46, 102, 97, 110, 121, 105, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 17, 42, 46, 103, 122, 46, 98, 97, 105, 100, 117, 98, 99, 101, 46, 99, 111, 109, -126, 18, 42, 46, 104, 97, 111, 49, 50, 51, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 12, 42, 46, 104, 97, 111, 49, 50, 51, 46, 99, 111, 109, -126, 12, 42, 46, 104, 97, 111, 50, 50, 50, 46, 99, 111, 109, -126, 14, 42, 46, 105, 109, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 15, 42, 46, 109, 97, 112, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 15, 42, 46, 109, 98, 100, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 12, 42, 46, 109, 105, 112, 99, 100, 110, 46, 99, 111, 109, -126, 16, 42, 46, 110, 101, 119, 115, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 11, 42, 46, 110, 117, 111, 109, 105, 46, 99, 111, 109, -126, 16, 42, 46, 115, 97, 102, 101, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 14, 42, 46, 115, 109, 97, 114, 116, 97, 112, 112, 115, 46, 99, 110, -126, 17, 42, 46, 115, 115, 108, 50, 46, 100, 117, 97, 112, 112, 115, 46, 99, 111, 109, -126, 14, 42, 46, 115, 117, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 13, 42, 46, 116, 114, 117, 115, 116, 103, 111, 46, 99, 111, 109, -126, 18, 42, 46, 120, 117, 101, 115, 104, 117, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, -126, 11, 97, 112, 111, 108, 108, 111, 46, 97, 117, 116, 111, -126, 10, 98, 97, 105, 102, 97, 101, 46, 99, 111, 109, -126, 12, 98, 97, 105, 102, 117, 98, 97, 111, 46, 99, 111, 109, -126, 6, 100, 119, 122, 46, 99, 110, -126, 15, 109, 99, 116, 46, 121, 46, 110, 117, 111, 109, 105, 46, 99, 111, 109, -126, 12, 119, 119, 119, 46, 98, 97, 105, 100, 117, 46, 99, 110, -126, 16, 119, 119, 119, 46, 98, 97, 105, 100, 117, 46, 99, 111, 109, 46, 99, 110, 48, 29, 6, 3, 85, 29, 37, 4, 22, 48, 20, 6, 8, 43, 6, 1, 5, 5, 7, 3, 1, 6, 8, 43, 6, 1, 5, 5, 7, 3, 2, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 118, -75, -26, -42, 73, -8, -8, 54, -22, 117, -87, 109, 94, 77, 85, 91, 55, 92, -3, -57, 48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, -128, 20, -106, -34, 97, -15, -67, 28, 22, 41, 83, 28, -64, -52, 125, 59, -125, 0, 64, -26, 26, 124, 48, -126, 1, 4, 6, 10, 43, 6, 1, 4, 1, -42, 121, 2, 4, 2, 4, -127, -11, 4, -127, -14, 0, -16, 0, 118, 0, -69, -39, -33, -68, 31, -118, 113, -75, -109, -108, 35, -105, -86, -110, 123, 71, 56, 87, -107, 10, -85, 82, -24, 26, -112, -106, 100, 54, -114, 30, -47, -123, 0, 0, 1, 106, -102, 46, -31, -102, 0, 0, 4, 3, 0, 71, 48, 69, 2, 32, 44, 123, 77, -64, -7, -123, 71, -118, 45, 10, -64, 121, 59, -42, -76, -75, 102, -8, -86, -5, -126, 88, -83, 35, 54, -2, 22, -68, -90, -125, -103, 33, 2, 33, 0, -64, 47, -51, -100, -103, 32, -53, 125, -111, 95, -46, -117, -58, 19, 16, 115, -75, -63, 84, 3, 51, 65, -97, -90, 106, -59, 20, -109, -49, 105, 43, 107, 0, 118, 0, 111, 83, 118, -84, 49, -16, 49, 25, -40, -103, 0, -92, 81, 21, -1, 119, 21, 28, 17, -39, 2, -63, 0, 41, 6, -115, -78, 8, -102, 55, -39, 19, 0, 0, 1, 106, -102, 46, -34, 79, 0, 0, 4, 3, 0, 71, 48, 69, 2, 32, 3, 50, 104, -98, 57, -48, -21, 95, 25, 97, -37, -89, 18, 105, 111, 40, 68, -127, 2, -91, 60, -62, -93, 19, -43, 126, -104, 38, 95, 32, 26, -96, 2, 33, 0, -89, -117, 98, -77, -80, -76, 68, 50, -30, 17, -1, 69, -115, 85, 17, 44, 54, -85, 41, -109, 68, -56, 52, 92, -50, 124, 53, 87, 49, -82, -85, 18, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 11, 5, 0, 3, -126, 1, 1, 0, -86, -71, -51, 82, -114, -36, 54, 93, 71, -44, -117, -13, 50, 23, 6, 70, -125, 96, -93, 39, 5, 73, 41, -79, 27, 70, 110, 56, -2, -109, -2, 9, 67, 108, -46, -95, 88, 36, 18, 66, -73, -85, 65, -8, 71, 10, 125, 100, -75, 117, -36, 90, 69, 20, -78, -92, 24, 107, -100, -73, 59, -113, -77, 126, -46, -67, -64, 114, 75, 53, 5, -82, 13, 45, 25, 31, 80, 115, 114, 90, -33, -105, 24, 59, -37, 42, -13, -34, 68, -50, 100, 45, -63, 30, -124, -52, 118, 36, 62, 48, 103, 35, 38, -24, 79, -9, 11, -10, -20, 105, -41, 127, 81, -87, -96, 111, -72, -60, 20, -30, -64, 74, 74, -60, 0, 93, 87, 106, -55, 65, -60, 37, 43, 50, 24, -86, 98, -88, 30, 73, -127, 115, 28, -127, 95, 94, -6, -28, -108, 50, -61, 80, 109, -114, -86, -52, 108, 76, 83, 12, -6, -113, 78, 52, 121, -97, -91, 96, -64, -8, 80, 117, -72, -95, -99, 1, -26, -85, 37, 35, 12, 59, 36, 2, 64, 88, 36, -1, 52, 2, -117, -108, 97, 16, 104, 47, -74, -128, -29, -48, 95, 74, 10, -89, 2, -46, -64, -104, 62, 29, -24, 2, -56, 39, 113, 38, -78, -88, -121, -74, -37, -99, 16, 71, 75, -62, 19, 98, 52, -58, -48, 60, 57, 9, 57, 37, -113, -2, -94, -12, -13, -5, -33, -101, 39, 61, -4, -48, 40, -24, 109, -36, -35, 23, -45, 31, 0, 4, 109, 48, -126, 4, 105, 48, -126, 3, 81, -96, 3, 2, 1, 2, 2, 11, 4, 0, 0, 0, 0, 1, 68, 78, -16, 66, 71, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 11, 5, 0, 48, 87, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 66, 69, 49, 25, 48, 23, 6, 3, 85, 4, 10, 19, 16, 71, 108, 111, 98, 97, 108, 83, 105, 103, 110, 32, 110, 118, 45, 115, 97, 49, 16, 48, 14, 6, 3, 85, 4, 11, 19, 7, 82, 111, 111, 116, 32, 67, 65, 49, 27, 48, 25, 6, 3, 85, 4, 3, 19, 18, 71, 108, 111, 98, 97, 108, 83, 105, 103, 110, 32, 82, 111, 111, 116, 32, 67, 65, 48, 30, 23, 13, 49, 52, 48, 50, 50, 48, 49, 48, 48, 48, 48, 48, 90, 23, 13, 50, 52, 48, 50, 50, 48, 49, 48, 48, 48, 48, 48, 90, 48, 102, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 66, 69, 49, 25, 48, 23, 6, 3, 85, 4, 10, 19, 16, 71, 108, 111, 98, 97, 108, 83, 105, 103, 110, 32, 110, 118, 45, 115, 97, 49, 60, 48, 58, 6, 3, 85, 4, 3, 19, 51, 71, 108, 111, 98, 97, 108, 83, 105, 103, 110, 32, 79, 114, 103, 97, 110, 105, 122, 97, 116, 105, 111, 110, 32, 86, 97, 108, 105, 100, 97, 116, 105, 111, 110, 32, 67, 65, 32, 45, 32, 83, 72, 65, 50, 53, 54, 32, 45, 32, 71, 50, 48, -126, 1, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126, 1, 15, 0, 48, -126, 1, 10, 2, -126, 1, 1, 0, -57, 14, 108, 63, 35, -109, 127, -52, 112, -91, -99, 32, -61, 14, 83, 63, 126, -64, 78, -62, -104, 73, -54, 71, -43, 35, -17, 3, 52, -123, 116, -56, -93, 2, 46, 70, 92, 11, 125, -55, -120, -99, 79, -117, -16, -8, -100, 108, -116, 85, 53, -37, -65, -14, -77, -22, -5, -29, 86, -25, 74, 70, -39, 19, 34, -54, 54, -43, -101, -63, -88, -29, -106, 67, -109, -14, 12, -68, -26, -7, -26, -24, -103, -56, 99, 72, 120, 127, 87, 54, 105, 26, 25, 29, 90, -47, -44, 125, -62, -100, -44, 127, -31, -128, 18, -82, 122, -22, -120, -22, 87, -40, -54, 10, 10, 58, 18, 73, -94, 98, 25, 122, 13, 36, -9, 55, -21, -76, 115, -110, 123, 5, 35, -101, 18, -75, -50, -21, 41, -33, -92, 20, 2, -71, 1, -91, -44, -90, -100, 67, 100, -120, -34, -8, 126, -2, -29, -11, 30, -27, -2, -36, -93, -88, -28, 102, 49, -39, 76, 37, -23, 24, -71, -119, 89, 9, -82, -23, -99, 28, 109, 55, 15, 74, 30, 53, 32, 40, -30, -81, -44, 33, -117, 1, -60, 69, -83, 110, 43, 99, -85, -110, 107, 97, 10, 77, 32, -19, 115, -70, 124, -50, -2, 22, -75, -37, -97, -128, -16, -42, -117, 108, -39, 8, 121, 74, 79, 120, 101, -38, -110, -68, -66, 53, -7, -77, -60, -7, 39, -128, 78, -1, -106, 82, -26, 2, 32, -31, 7, 115, -23, 93, 43, -67, -78, -15, 2, 3, 1, 0, 1, -93, -126, 1, 37, 48, -126, 1, 33, 48, 14, 6, 3, 85, 29, 15, 1, 1, -1, 4, 4, 3, 2, 1, 6, 48, 18, 6, 3, 85, 29, 19, 1, 1, -1, 4, 8, 48, 6, 1, 1, -1, 2, 1, 0, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, -106, -34, 97, -15, -67, 28, 22, 41, 83, 28, -64, -52, 125, 59, -125, 0, 64, -26, 26, 124, 48, 71, 6, 3, 85, 29, 32, 4, 64, 48, 62, 48, 60, 6, 4, 85, 29, 32, 0, 48, 52, 48, 50, 6, 8, 43, 6, 1, 5, 5, 7, 2, 1, 22, 38, 104, 116, 116, 112, 115, 58, 47, 47, 119, 119, 119, 46, 103, 108, 111, 98, 97, 108, 115, 105, 103, 110, 46, 99, 111, 109, 47, 114, 101, 112, 111, 115, 105, 116, 111, 114, 121, 47, 48, 51, 6, 3, 85, 29, 31, 4, 44, 48, 42, 48, 40, -96, 38, -96, 36, -122, 34, 104, 116, 116, 112, 58, 47, 47, 99, 114, 108, 46, 103, 108, 111, 98, 97, 108, 115, 105, 103, 110, 46, 110, 101, 116, 47, 114, 111, 111, 116, 46, 99, 114, 108, 48, 61, 6, 8, 43, 6, 1, 5, 5, 7, 1, 1, 4, 49, 48, 47, 48, 45, 6, 8, 43, 6, 1, 5, 5, 7, 48, 1, -122, 33, 104, 116, 116, 112, 58, 47, 47, 111, 99, 115, 112, 46, 103, 108, 111, 98, 97, 108, 115, 105, 103, 110, 46, 99, 111, 109, 47, 114, 111, 111, 116, 114, 49, 48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, -128, 20, 96, 123, 102, 26, 69, 13, -105, -54, -119, 80, 47, 125, 4, -51, 52, -88, -1, -4, -3, 75, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 11, 5, 0, 3, -126, 1, 1, 0, 70, 42, -18, 94, -67, -82, 1, 96, 55, 49, 17, -122, 113, 116, -74, 70, 73, -56, 16, 22, -2, 47, 98, 35, 23, -85, 31, -121, -8, -126, -19, -54, -33, 14, 44, -33, 100, 117, -114, -27, 24, 114, -89, -116, 58, -117, -55, -84, -91, 119, 80, -9, -17, -98, -92, -32, -96, -113, 20, 87, -93, 42, 95, -20, 126, 109, 16, -26, -70, -115, -80, 8, -121, 118, 14, 76, -78, -39, 81, -69, 17, 2, -14, 92, -35, 28, -67, -13, 85, -106, 15, -44, 6, -64, -4, -30, 35, -118, 36, 112, -45, -69, -16, 121, 26, -89, 97, 112, -125, -118, -81, 6, -59, 32, -40, -95, 99, -48, 108, -82, 79, 50, -41, -82, 124, 24, 69, 117, 5, 41, 119, -33, 66, 64, 100, 100, -122, -66, 42, 118, 9, 49, 111, 29, 36, -12, -103, -48, -123, -2, -14, 33, 8, -7, -58, -10, -15, -48, 89, -19, -42, 86, 60, 8, 40, 3, 103, -70, -16, -7, -15, -112, 22, 71, -82, 103, -26, -68, -128, 72, -23, 66, 118, 52, -105, 85, 105, 36, 14, -125, -42, -96, 45, -76, -11, -13, 121, -118, 73, 40, 116, 26, 65, -95, -62, -45, 36, -120, 53, 48, 96, -108, 23, -76, -31, 4, 34, 49, 61, 59, 47, 23, 6, -78, -72, -99, -122, 43, 90, 105, -17, -125, -11, 75, -60, -86, -76, 42, -8, 124, -95, -79, -123, -108, -116, -12, 12, -121, 12, -12, -84, 64, -8, 89, 73, -104 };
//		byte[] bytes = new byte[] { 48, -126, 1, -87, 48, -126, 1, 18, -96, 3, 2, 1, 2, 2, 8, 27, 20, 52, -36, -107, 120, 102, 52, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 5, 5, 0, 48, 22, 49, 20, 48, 18, 6, 3, 85, 4, 3, 19, 11, 101, 120, 97, 109, 112, 108, 101, 46, 99, 111, 109, 48, 32, 23, 13, 49, 57, 48, 52, 49, 55, 49, 52, 49, 50, 48, 54, 90, 24, 15, 57, 57, 57, 57, 49, 50, 51, 49, 50, 51, 53, 57, 53, 57, 90, 48, 22, 49, 20, 48, 18, 6, 3, 85, 4, 3, 19, 11, 101, 120, 97, 109, 112, 108, 101, 46, 99, 111, 109, 48, -127, -97, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -127, -115, 0, 48, -127, -119, 2, -127, -127, 0, -117, 18, -22, 67, 90, -99, -115, 101, 65, 40, 112, -75, 93, 18, 110, -127, 24, 54, 68, 116, -59, 103, -33, -37, -63, 92, -111, -47, 56, -91, -84, 8, 41, -79, -4, -22, -127, -49, -60, -27, -60, -81, -65, -86, -29, -90, -49, 107, 17, -49, -24, 92, 120, -16, 125, -58, -53, 83, -67, 113, -45, 123, 31, -7, 61, -101, 68, -87, -23, 52, -41, 86, -68, -33, -50, -90, 16, -73, -29, 31, -84, -110, -37, -109, 101, 3, -28, -6, -108, -23, -15, -59, -97, 88, -34, -94, -1, 76, 88, 0, 108, -42, -2, -114, 38, -68, -3, 47, 30, 122, 46, -44, 72, -6, 74, -116, -22, 7, 102, 65, 112, -4, 21, -110, -10, 102, -87, 7, 2, 3, 1, 0, 1, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 5, 5, 0, 3, -127, -127, 0, 54, -15, -115, 66, 22, -90, -59, -83, 7, -15, -59, 99, -9, -58, 46, -73, 8, 63, 7, 59, -86, -34, 50, -127, 110, 59, -56, 73, -37, -106, -102, 37, 33, 77, 114, 113, 92, 53, -30, 57, 83, 69, 60, 26, 19, 5, -51, 57, 86, 123, 111, -16, -13, -17, 1, -15, 31, -5, 82, 57, 32, 98, -87, -6, 29, -84, 90, -89, -118, 106, 9, -22, 18, -78, 59, 78, -86, 19, 105, 72, -48, 83, 60, 118, 44, 110, 81, 88, -37, -95, -41, -113, 84, -126, -54, -93, 126, 122, 80, 44, -8, -50, -12, 47, -30, -88, -78, 57, -70, 0, -29, 27, -11, 117, 19, -90, -92, 3, 112, 5, -42, -33, 83, 44, 4, 71, 63, 79, 12, 0, 0, -55, 3, 0, 23, 65, 4, 77, -37, -49, 118, -118, 65, -63, -3, -124, -64, 48, 39, -43, 17, -97, -83, 76, 117, 125, -112, 28, 124, -85, 23, -47, 40, -55, -85, -111, 112, 51, 10, 66, -6, -73, 103, 18, 62, -37, 84, -2, -104, 64, 101, -111, 22, 60, -121, 103, 95, -70, 77, 10, -30, 37, -119, 3, -55, -111, 20, 14, -80, 41, 2, 4, 1, 0, -128, 14, 76, 74, 12, -50, -22, 31, 42, -20, -75, 43, -101, -62, 122, -105, -120, -58, 65, -86, 3, 4, -111, -59, 49, 34, 76, 45, 1, 92, 117, 96, 34, -89, -6, -50, -44, -33, -114, -35, -19, -80, 44, -117, -9, -74, 50, -34, -61, 127, -63, 81, -36, 68, -60, -48, 126, 107, 97, 14, -61, -120, -92, 89, 16, -101, -44, -76, 107, -106, 88, -55, -50, -53, -56, 52, 82, 118, 120, -81, 74, -108, 93, 21, -73, 100, 108, 118, 15, -93, -84, 111, -108, 104, -120, -1, 83, 23, -70, -66, 118, -101, -86, -46, 54, 19, 67, 12, 81, -75, -83, -115, 108, 8, -12, -29, -110, 72, -23, 120, -6, -8, 10, 27, 59, -68, 40, -87, 8, 14, 0, 0, 0 };
		byte[] bytes = new byte[] { 48, -126, 3, 119, 48, -126, 2, 95, -96, 3, 2, 1, 2, 2, 4, 47, 90, 12, -107, 48, 13,
				6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 11, 5, 0, 48, 108, 49, 16, 48, 14, 6, 3, 85, 4, 6, 19, 7, 85,
				110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4, 8, 19, 7, 85, 110, 107, 110, 111, 119, 110,
				49, 16, 48, 14, 6, 3, 85, 4, 7, 19, 7, 85, 110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4,
				10, 19, 7, 85, 110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4, 11, 19, 7, 85, 110, 107, 110,
				111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4, 3, 19, 7, 85, 110, 107, 110, 111, 119, 110, 48, 30, 23, 13,
				50, 48, 48, 52, 49, 51, 49, 51, 49, 50, 51, 55, 90, 23, 13, 51, 48, 48, 52, 49, 49, 49, 51, 49, 50, 51,
				55, 90, 48, 108, 49, 16, 48, 14, 6, 3, 85, 4, 6, 19, 7, 85, 110, 107, 110, 111, 119, 110, 49, 16, 48,
				14, 6, 3, 85, 4, 8, 19, 7, 85, 110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 19, 7, 85,
				110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4, 10, 19, 7, 85, 110, 107, 110, 111, 119, 110,
				49, 16, 48, 14, 6, 3, 85, 4, 11, 19, 7, 85, 110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4,
				3, 19, 7, 85, 110, 107, 110, 111, 119, 110, 48, -126, 1, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13,
				1, 1, 1, 5, 0, 3, -126, 1, 15, 0, 48, -126, 1, 10, 2, -126, 1, 1, 0, -68, 14, 4, 64, 59, 109, -70, 126,
				116, 106, 55, 123, -99, 36, 70, -40, -98, -18, 88, 58, 39, -103, -66, -89, 124, 109, 86, 104, 116, 126,
				118, 22, 122, -34, 82, 19, -29, 50, -120, -87, 114, 12, -49, 123, 28, -55, -108, -50, -66, -35, 32, -79,
				-118, 31, 106, -91, -118, -22, -107, -51, -122, 52, 38, -25, -73, -113, 73, 27, -47, 22, -62, -85, 22,
				-12, -95, -90, -38, -48, 19, 123, -45, -80, 48, 95, 51, 21, 4, 79, 108, -4, 96, 65, 118, -58, 91, -111,
				65, -2, -76, -65, 15, -20, 38, -39, 39, -53, 94, 52, -119, 87, 49, 74, -50, -99, -28, -28, 88, -60, 63,
				-48, 63, 69, -24, 13, -111, -128, 111, 97, 46, -31, -38, -25, 48, -40, 86, -74, -9, 14, 62, 99, -7, 2,
				-118, 98, -44, -116, -77, -90, -113, -50, 28, -59, 118, -14, 96, -77, -53, -41, -85, -22, -95, -50, -42,
				-97, 15, 122, 85, 23, 5, 114, 80, -14, -97, -127, -19, -106, 119, -23, 110, -33, -96, -30, -87, 109,
				107, 31, -63, -98, -95, 16, 60, -128, 36, -68, 9, 31, -26, -35, -12, 73, -69, 68, -64, -23, -75, -117,
				-67, -77, 122, 71, -28, 85, 7, -99, 102, 43, -103, -54, 48, 109, 103, -83, 76, -116, 119, 122, 63, 102,
				-118, 114, 75, 9, 51, -3, -68, -70, -40, 32, -96, -5, -41, -17, 28, 41, 4, -16, 123, 56, 49, -62, -117,
				27, -4, 74, -59, -53, 2, 3, 1, 0, 1, -93, 33, 48, 31, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 7, -42,
				44, 112, -35, -56, 14, -21, 58, -120, -44, 114, 13, -108, -38, 108, -54, -38, -80, 89, 48, 13, 6, 9, 42,
				-122, 72, -122, -9, 13, 1, 1, 11, 5, 0, 3, -126, 1, 1, 0, -86, 18, -18, -93, 113, -110, 40, -12, 113,
				66, -4, 68, -107, 46, 39, 56, 52, -119, -63, -113, 39, 115, -32, -32, -112, -113, -16, 108, 124, 36, 58,
				78, 104, 106, -8, 115, 99, -120, -11, 76, -39, -87, 104, 59, 94, -73, -113, 5, -119, -20, 66, -64, -72,
				57, 10, 109, 80, 18, 69, -88, 84, -3, 89, 63, 29, 17, -78, -117, 50, 18, -100, 6, -10, -39, 60, -10,
				126, 111, 54, 30, -44, -100, -43, -105, 30, -72, 110, 17, -112, 100, 113, 40, 114, -26, 40, -20, 93,
				-53, 119, 14, -38, 104, -98, 73, -86, -78, -39, -18, -38, 53, -104, 108, -54, 61, 0, -73, 108, -29, 49,
				111, 51, 40, -77, 31, 120, -42, -84, -123, -10, 100, -45, -60, 80, 15, -39, -74, 63, -97, -18, 97, 98,
				-103, 39, -85, 48, 8, 55, 52, 82, -101, -63, 88, -84, -126, -125, -42, -110, -67, 83, -11, 35, -55, 66,
				93, 99, -65, 19, 102, 79, 33, 125, 5, -113, 112, -20, -121, 50, 79, 108, -35, -48, -73, -113, 36, -14,
				7, 96, -107, -13, -44, 31, 78, -9, -37, -61, -35, -1, -103, 125, 10, -19, 113, -5, -96, -109, 3, 126,
				-37, -83, -64, 13, -118, -118, 68, -24, 19, 17, 109, 57, 113, -64, 58, 97, 89, -83, 49, -119, -33, -86,
				32, -35, 68, 10, 52, -46, -17, 36, 109, -116, -2, -64, -60, -41, 3, 86, 126, -54, -47, -103, 122, 9, 83,
				42, 24, -4, 126, 12, 0, 1, 73, 3, 0, 23, 65, 4, -122, -124, -28, 2, -21, 79, -121, 79, 9, -12, -54, -1,
				-47, -73, 40, -65, -92, 7, -75, -104, 65, 68, 37, -39, 6, -45, 76, -106, 10, 91, 115, 90, 95, -89, 13,
				-54, 40, -98, -99, 27, 74, 74, -41, -64, -84, 125, 94, -60, -87, -124, -112, 33, -114, 2, -32, -29,
				-117, -37, 113, 8, -116, -99, 61, 121, 4, 1, 1, 0, -95, 124, -73, 119, -7, 47, 45, 105, -9, 84, -73,
				-127, 56, 67, 88, 15, -37, 10, 84, 27, -41, -63, -71, -15, -4, -13, 57, 106, 125, -21, -59, -41, -61,
				-104, -108, -3, 8, 13, -3, 26, 85, -68, -76, 42, -79, -57, 97, -103, -70, 6, -85, 40, -66, -56, 75, 96,
				-32, 72, 3, -54, 44, 36, -98, 97, -29, 44, -47, 112, 45, 108, 106, -68, 121, -62, -125, -3, -107, 32,
				29, 118, -87, 32, 58, -68, 9, 100, 100, 10, -25, 122, 93, -46, 75, 40, 53, 62, -62, 100, -44, -9, -80,
				116, 35, 60, 111, 48, 8, -17, -122, -40, 70, 108, -32, 69, 20, 14, -78, -99, 62, 94, 21, -29, -63, -126,
				12, -23, 77, 21, 31, 20, -14, -9, -128, 79, 105, -46, 21, 30, -2, 118, 25, 59, 68, 2, -43, 78, -63, 52,
				60, -105, 106, -103, 126, -93, -30, 92, -102, -67, -125, -44, -95, -23, -16, -44, 109, 85, 84, -63,
				-101, -87, -64, -44, 127, 19, -13, 56, 93, -117, -80, 104, 43, -65, 40, 63, 103, 62, 9, 123, -115, 80,
				-49, -100, 79, -107, -50, 94, -128, -127, 55, 102, -113, 53, -43, 85, 12, 67, -91, 15, -13, 105, -46,
				35, -18, -29, -66, -119, 123, 42, 81, 11, 90, -2, 3, -27, -14, -116, 64, -104, -74, -99, -68, -86, -127,
				-118, 102, -85, -125, 92, 23, 34, -54, -108, 33, -49, -110, -118, 11, -77, 119, -30, 46, 74, 118, -63,
				-100, -48, 14, 0, 0, 0 };
		CertificateFactory cf = CertificateFactory.getInstance("X.509");
		X509Certificate cert = (X509Certificate) cf.generateCertificate(new ByteArrayInputStream(bytes));
		System.out.println(cert);
	}

	@Test
	public void testFlushCert() throws Exception {
		byte[] bytes = new byte[] { 48, -126, 3, 119, 48, -126, 2, 95, -96, 3, 2, 1, 2, 2, 4, 47, 90, 12, -107, 48, 13,
				6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 11, 5, 0, 48, 108, 49, 16, 48, 14, 6, 3, 85, 4, 6, 19, 7, 85,
				110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4, 8, 19, 7, 85, 110, 107, 110, 111, 119, 110,
				49, 16, 48, 14, 6, 3, 85, 4, 7, 19, 7, 85, 110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4,
				10, 19, 7, 85, 110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4, 11, 19, 7, 85, 110, 107, 110,
				111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4, 3, 19, 7, 85, 110, 107, 110, 111, 119, 110, 48, 30, 23, 13,
				50, 48, 48, 52, 49, 51, 49, 51, 49, 50, 51, 55, 90, 23, 13, 51, 48, 48, 52, 49, 49, 49, 51, 49, 50, 51,
				55, 90, 48, 108, 49, 16, 48, 14, 6, 3, 85, 4, 6, 19, 7, 85, 110, 107, 110, 111, 119, 110, 49, 16, 48,
				14, 6, 3, 85, 4, 8, 19, 7, 85, 110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4, 7, 19, 7, 85,
				110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4, 10, 19, 7, 85, 110, 107, 110, 111, 119, 110,
				49, 16, 48, 14, 6, 3, 85, 4, 11, 19, 7, 85, 110, 107, 110, 111, 119, 110, 49, 16, 48, 14, 6, 3, 85, 4,
				3, 19, 7, 85, 110, 107, 110, 111, 119, 110, 48, -126, 1, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13,
				1, 1, 1, 5, 0, 3, -126, 1, 15, 0, 48, -126, 1, 10, 2, -126, 1, 1, 0, -68, 14, 4, 64, 59, 109, -70, 126,
				116, 106, 55, 123, -99, 36, 70, -40, -98, -18, 88, 58, 39, -103, -66, -89, 124, 109, 86, 104, 116, 126,
				118, 22, 122, -34, 82, 19, -29, 50, -120, -87, 114, 12, -49, 123, 28, -55, -108, -50, -66, -35, 32, -79,
				-118, 31, 106, -91, -118, -22, -107, -51, -122, 52, 38, -25, -73, -113, 73, 27, -47, 22, -62, -85, 22,
				-12, -95, -90, -38, -48, 19, 123, -45, -80, 48, 95, 51, 21, 4, 79, 108, -4, 96, 65, 118, -58, 91, -111,
				65, -2, -76, -65, 15, -20, 38, -39, 39, -53, 94, 52, -119, 87, 49, 74, -50, -99, -28, -28, 88, -60, 63,
				-48, 63, 69, -24, 13, -111, -128, 111, 97, 46, -31, -38, -25, 48, -40, 86, -74, -9, 14, 62, 99, -7, 2,
				-118, 98, -44, -116, -77, -90, -113, -50, 28, -59, 118, -14, 96, -77, -53, -41, -85, -22, -95, -50, -42,
				-97, 15, 122, 85, 23, 5, 114, 80, -14, -97, -127, -19, -106, 119, -23, 110, -33, -96, -30, -87, 109,
				107, 31, -63, -98, -95, 16, 60, -128, 36, -68, 9, 31, -26, -35, -12, 73, -69, 68, -64, -23, -75, -117,
				-67, -77, 122, 71, -28, 85, 7, -99, 102, 43, -103, -54, 48, 109, 103, -83, 76, -116, 119, 122, 63, 102,
				-118, 114, 75, 9, 51, -3, -68, -70, -40, 32, -96, -5, -41, -17, 28, 41, 4, -16, 123, 56, 49, -62, -117,
				27, -4, 74, -59, -53, 2, 3, 1, 0, 1, -93, 33, 48, 31, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 7, -42,
				44, 112, -35, -56, 14, -21, 58, -120, -44, 114, 13, -108, -38, 108, -54, -38, -80, 89, 48, 13, 6, 9, 42,
				-122, 72, -122, -9, 13, 1, 1, 11, 5, 0, 3, -126, 1, 1, 0, -86, 18, -18, -93, 113, -110, 40, -12, 113,
				66, -4, 68, -107, 46, 39, 56, 52, -119, -63, -113, 39, 115, -32, -32, -112, -113, -16, 108, 124, 36, 58,
				78, 104, 106, -8, 115, 99, -120, -11, 76, -39, -87, 104, 59, 94, -73, -113, 5, -119, -20, 66, -64, -72,
				57, 10, 109, 80, 18, 69, -88, 84, -3, 89, 63, 29, 17, -78, -117, 50, 18, -100, 6, -10, -39, 60, -10,
				126, 111, 54, 30, -44, -100, -43, -105, 30, -72, 110, 17, -112, 100, 113, 40, 114, -26, 40, -20, 93,
				-53, 119, 14, -38, 104, -98, 73, -86, -78, -39, -18, -38, 53, -104, 108, -54, 61, 0, -73, 108, -29, 49,
				111, 51, 40, -77, 31, 120, -42, -84, -123, -10, 100, -45, -60, 80, 15, -39, -74, 63, -97, -18, 97, 98,
				-103, 39, -85, 48, 8, 55, 52, 82, -101, -63, 88, -84, -126, -125, -42, -110, -67, 83, -11, 35, -55, 66,
				93, 99, -65, 19, 102, 79, 33, 125, 5, -113, 112, -20, -121, 50, 79, 108, -35, -48, -73, -113, 36, -14,
				7, 96, -107, -13, -44, 31, 78, -9, -37, -61, -35, -1, -103, 125, 10, -19, 113, -5, -96, -109, 3, 126,
				-37, -83, -64, 13, -118, -118, 68, -24, 19, 17, 109, 57, 113, -64, 58, 97, 89, -83, 49, -119, -33, -86,
				32, -35, 68, 10, 52, -46, -17, 36, 109, -116, -2, -64, -60, -41, 3, 86, 126, -54, -47, -103, 122, 9, 83,
				42, 24, -4, 126, 12, 0, 1, 73, 3, 0, 23, 65, 4, -122, -124, -28, 2, -21, 79, -121, 79, 9, -12, -54, -1,
				-47, -73, 40, -65, -92, 7, -75, -104, 65, 68, 37, -39, 6, -45, 76, -106, 10, 91, 115, 90, 95, -89, 13,
				-54, 40, -98, -99, 27, 74, 74, -41, -64, -84, 125, 94, -60, -87, -124, -112, 33, -114, 2, -32, -29,
				-117, -37, 113, 8, -116, -99, 61, 121, 4, 1, 1, 0, -95, 124, -73, 119, -7, 47, 45, 105, -9, 84, -73,
				-127, 56, 67, 88, 15, -37, 10, 84, 27, -41, -63, -71, -15, -4, -13, 57, 106, 125, -21, -59, -41, -61,
				-104, -108, -3, 8, 13, -3, 26, 85, -68, -76, 42, -79, -57, 97, -103, -70, 6, -85, 40, -66, -56, 75, 96,
				-32, 72, 3, -54, 44, 36, -98, 97, -29, 44, -47, 112, 45, 108, 106, -68, 121, -62, -125, -3, -107, 32,
				29, 118, -87, 32, 58, -68, 9, 100, 100, 10, -25, 122, 93, -46, 75, 40, 53, 62, -62, 100, -44, -9, -80,
				116, 35, 60, 111, 48, 8, -17, -122, -40, 70, 108, -32, 69, 20, 14, -78, -99, 62, 94, 21, -29, -63, -126,
				12, -23, 77, 21, 31, 20, -14, -9, -128, 79, 105, -46, 21, 30, -2, 118, 25, 59, 68, 2, -43, 78, -63, 52,
				60, -105, 106, -103, 126, -93, -30, 92, -102, -67, -125, -44, -95, -23, -16, -44, 109, 85, 84, -63,
				-101, -87, -64, -44, 127, 19, -13, 56, 93, -117, -80, 104, 43, -65, 40, 63, 103, 62, 9, 123, -115, 80,
				-49, -100, 79, -107, -50, 94, -128, -127, 55, 102, -113, 53, -43, 85, 12, 67, -91, 15, -13, 105, -46,
				35, -18, -29, -66, -119, 123, 42, 81, 11, 90, -2, 3, -27, -14, -116, 64, -104, -74, -99, -68, -86, -127,
				-118, 102, -85, -125, 92, 23, 34, -54, -108, 33, -49, -110, -118, 11, -77, 119, -30, 46, 74, 118, -63,
				-100, -48, 14, 0, 0, 0 };
		FileOutputStream fileOutputStream = new FileOutputStream(new File(
				"/Users/hudaming/Workspace/GitHub/netty-proxy/src/test/java/org/hum/nettyproxy/test/https_client/certs/my.cer"));
		fileOutputStream.write(bytes);
		fileOutputStream.flush();
		fileOutputStream.close();
	}

	public static void main(String[] args) {
		read("/Users/hudaming/Workspace/GitHub/netty-proxy/src/test/java/org/hum/nettyproxy/test/officaldemo/ca_and_cert/myca/rootca/dynamic/huming_test2.p12",
				"123456");
		System.out.println("===================");
		read("/Users/hudaming/Workspace/GitHub/netty-proxy/src/test/java/org/hum/nettyproxy/test/officaldemo/ca_and_cert/myca/rootca/server/baidu_server.p12",
				"123456");
	}

	public static void read(String KEYSTORE_FILE, String KEYSTORE_PASSWORD) {

		try {

			KeyStore ks = KeyStore.getInstance("PKCS12");

			FileInputStream fis = new FileInputStream(KEYSTORE_FILE);

			// If the keystore password is empty(""), then we have to set

			// to null, otherwise it won't work!!!

			char[] nPassword = null;

			if ((KEYSTORE_PASSWORD == null) || KEYSTORE_PASSWORD.trim().equals("")) {
				nPassword = null;
			} else {
				nPassword = KEYSTORE_PASSWORD.toCharArray();
			}

			ks.load(fis, nPassword);

			fis.close();

			System.out.println("keystore type=" + ks.getType());

			// Now we loop all the aliases, we need the alias to get keys.

			// It seems that this value is the "Friendly name" field in the

			// detals tab <-- Certificate window <-- view <-- Certificate

			// Button <-- Content tab <-- Internet Options <-- Tools menu

			// In MS IE 6.

			Enumeration enum1 = ks.aliases();

			String keyAlias = null;

			// we are readin just one certificate.
			if (enum1.hasMoreElements()) {
				keyAlias = (String) enum1.nextElement();
				System.out.println("alias=[" + keyAlias + "]");
			}

			// Now once we know the alias, we could get the keys.

			// System.out.println("is key entry=" + ks.isKeyEntry(keyAlias));

			PrivateKey prikey = (PrivateKey) ks.getKey(keyAlias, nPassword);

			Certificate cert = ks.getCertificate(keyAlias);

			PublicKey pubkey = cert.getPublicKey();

			// System.out.println("cert class = " + cert.getClass().getName());

			System.out.println("cert = " + cert);

			// System.out.println("public key = " + pubkey);

			// System.out.println("private key = " + prikey);

		} catch (Exception e) {
			e.printStackTrace();
		}

	}
}
